Page({
  data: {
      input: '',
      result: ''
  },
  onInputChange(e) {
      this.setData({
          input: e.detail.value
      });
  },
  addRelationship(e) {
      const relationship = e.currentTarget.dataset.relationship;
      let input = this.data.input;
      if (input) {
          input += '的' + relationship;
      } else {
          input = relationship;
      }
      this.setData({
          input: input
      });
  },
  deleteLastRelationship() {
      let input = this.data.input;
      const lastIndex = input.lastIndexOf('的');
      if (lastIndex !== -1) {
          input = input.slice(0, lastIndex);
      } else {
          input = '';
      }
      this.setData({
          input: input
      });
  },
  clearInput() {
      this.setData({
          input: '',
          result: ''
      });
  },
  calculateKinship() {
      const input = this.data.input;
      const basicRelationships = {
          "父亲": "爸爸",
          "母亲": "妈妈",
          "儿子": "儿子",
          "女儿": "女儿",
          "父亲的父亲": "爷爷",
          "父亲的母亲": "奶奶",
          "母亲的父亲": "外公",
          "母亲的母亲": "外婆",
          "父亲的哥哥": "伯伯",
          "父亲的弟弟": "叔叔",
          "父亲的姐姐": "姑妈",
          "父亲的妹妹": "姑妈",
          "父亲的妻子": "母亲",
          "母亲的哥哥": "大舅",
          "母亲的弟弟": "小舅",
          "母亲的姐姐": "大姨",
          "母亲的妹妹": "小姨",
          "母亲的丈夫" :"父亲",
          "伯伯的儿子": "堂哥",
          "伯伯的女儿": "堂姐",
          "叔叔的儿子": "堂弟",
          "叔叔的女儿": "堂妹",
          "姑姑的儿子": "表哥",
          "姑姑的女儿": "表姐",
          "舅舅的儿子": "表哥",
          "舅舅的女儿": "表姐",
          "姨妈的儿子": "表哥",
          "姨妈的女儿": "表姐",
          "哥哥的妻子": "嫂子",
          "弟弟的妻子": "弟妹",
          "姐姐的丈夫": "姐夫",
          "妹妹的丈夫": "妹夫",
          "妻子的父亲": "岳父",
          "妻子的母亲": "岳母",
          "丈夫的父亲": "公公",
          "丈夫的母亲": "婆婆",
          "伯伯的儿子": "堂哥",
          "伯伯的女儿": "堂姐",
          "叔叔的儿子": "堂弟",
          "叔叔的女儿": "堂妹",
          "姑姑的儿子": "表哥",
          "姑姑的女儿": "表姐",
          "舅舅的儿子": "表哥",
          "舅舅的女儿": "表姐",
          "姨妈的儿子": "表哥",
          "姨妈的女儿": "表姐",
          "哥哥的妻子": "嫂子",
          "弟弟的妻子": "弟妹",
          "姐姐的丈夫": "姐夫",
          "妹妹的丈夫": "妹夫",
          "哥哥的父亲": "父亲",
          "哥哥的母亲": "母亲",
          "哥哥的哥哥": "哥哥",
          "哥哥的弟弟": "哥哥，弟弟，我",
          "哥哥的姐姐": "姐姐",
          "哥哥的妹妹": "姐姐，妹妹，我",
          "哥哥的儿子": "侄子",
          "哥哥的女儿": "侄女",
          "弟弟的妻子": "弟妹",
          "弟弟的爸爸": "爸爸",
          "弟弟的母亲": "母亲",
          "弟弟的哥哥": "哥哥，弟弟，我",
          "弟弟的弟弟": "弟弟",
          "弟弟的姐姐": "妹妹，姐姐，我",
          "弟弟的妹妹": "妹妹",
          "弟弟的儿子": "侄子",
          "弟弟的女儿": "侄女",
          "姐姐的父亲": "父亲",
          "姐姐的母亲": "母亲",
          "姐姐的哥哥": "哥哥",
          "姐姐的弟弟": "哥哥，弟弟，我",
          "姐姐的姐姐": "姐姐",
          "姐姐的妹妹": "姐姐，妹妹，我",
          "姐姐的儿子": "外甥",
          "姐姐的女儿": "外甥女",
          "妹妹的父亲": "父亲",
          "妹妹的母亲": "母亲",
          "妹妹的哥哥": "哥哥，弟弟，我",
          "妹妹的弟弟": "弟弟",
          "妹妹的姐姐": "姐姐，妹妹，我",
          "妹妹的妹妹": "妹妹",
          "妹妹的儿子": "外甥",
          "妹妹的女儿": "外甥女",
          "妻子的父亲": "岳父",
          "妻子的母亲": "岳母",
          "妻子的丈夫": "我",
          "丈夫的父亲": "公公",
          "丈夫的母亲": "婆婆",
          "丈夫的妻子": "我",
          "丈夫的哥哥": "大伯子",
          "丈夫的弟弟": "小叔子",
          "丈夫的姐姐": "大姑子",
          "丈夫的妹妹": "小姑子",
          "丈夫的儿子": "儿子",
          "丈夫的女儿": "女儿",
          "妻子的哥哥": "大舅子",
          "妻子的弟弟": "小舅子",
          "妻子的姐姐": "大姨子",
          "妻子的妹妹": "小姨子",
          "妻子的儿子": "儿子",
          "妻子的女儿": "女儿",
          "儿子的父亲": "丈夫，我",
          "儿子的母亲": "妻子，我",
          "儿子的哥哥": "大儿子",
          "儿子的弟弟": "小儿子",
          "儿子的姐姐": "女儿",
          "儿子的妹妹": "女儿",
          "儿子的妻子": "儿媳妇",
          "儿子的儿子": "孙子",
          "儿子的女儿": "孙女",
          "女儿的父亲": "丈夫，我",
          "女儿的母亲": "妻子，我",
          "女儿的哥哥": "儿子",
          "女儿的弟弟": "儿子",
          "女儿的姐姐": "大女儿",
          "女儿的妹妹": "小女儿",
          "女儿的丈夫": "女婿",
          "女儿的儿子": "外孙",
          "女儿的女儿": "外孙女",
          "父亲的儿子": "哥哥，弟弟，我",
          "母亲的儿子": "哥哥，弟弟，我",
          "父亲的女儿": "姐姐，妹妹，我",
          "母亲的女儿": "姐姐，妹妹，我",
          "父亲的父亲的父亲": "曾祖父",
          "父亲的父亲的母亲": "曾祖母",
          "父亲的父亲的哥哥": "伯祖父",
          "父亲的父亲的弟弟": "叔祖父",
          "父亲的父亲的姐姐": "姑奶奶",
          "父亲的父亲的妹妹": "姑奶奶",
          "父亲的父亲的儿子": "叔叔，伯父，父亲",
          "父亲的父亲的女儿": "姑妈",
          "父亲的父亲的妻子": "奶奶",
          "父亲的母亲的父亲": "曾外祖父",
          "父亲的母亲的哥哥": "舅公",
          "父亲的母亲的弟弟": "舅公",
          "父亲的母亲的姐姐": "姨奶奶",
          "父亲的母亲的妹妹": "姨奶奶",
          "父亲的母亲的儿子": "叔叔，伯父，爸爸",
          "父亲的母亲的女儿": "姑妈",
          "父亲的母亲的丈夫": "爷爷",
      };

      const parts = input.split('的');
      if (parts.length > 2) {
          this.setData({
              result: "输入的辈分叠加超过 2 次，请重新输入。"
          });
          return;
      }

      let currentRelationship = parts[0];
      for (let i = 1; i < parts.length; i++) {
          const newPart = parts[i];
          const combined = `${currentRelationship}的${newPart}`;
          if (basicRelationships[combined]) {
              currentRelationship = basicRelationships[combined];
          } else {
              this.setData({
                  result: "未找到对应的称呼，请输入其他关系。"
              });
              return;
          }
      }

      this.setData({
          result: currentRelationship
      });
  }
});
  